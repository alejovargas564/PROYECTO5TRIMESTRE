<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>GestiÃ³n de Usuarios - SAPIB</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        :root {
            --primary: #4F46E5;
            --secondary: #14B8A6;
            --soft-bg: #F5F7FA;
        }
    </style>
</head>

<body class="bg-[var(--soft-bg)]">

<!-- NAVBAR -->
<header class="w-full bg-white shadow-md">
    <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">

        <div class="flex items-center space-x-3">
            <img src="/img/logo sapib.jpeg"
                 class="h-12 w-auto rounded-lg shadow">
            <span class="text-2xl font-bold text-[var(--primary)]">SAPIB</span>
            <span th:text="${#authentication.name}"></span>
        </div>
         <ul class="flex space-x-6 font-medium text-gray-700">
            <li><a href="/admin-home" class="hover:text-primary">Inicio</a></li>
           
        </ul>
        

        <form th:action="@{/logout}" method="post">
           <button class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 shadow">
               ðŸ”“ Cerrar sesiÃ³n
            </button>
        </form>
    </div>
</header>

<!-- CONTENIDO -->
<section class="max-w-7xl mx-auto px-6 py-10">

    <h1 class="text-4xl font-bold text-[var(--primary)] mb-6">
        GestiÃ³n de Usuarios
    </h1>

    <!-- BUSCADOR -->
    <form id="form-busqueda" th:action="@{/usuarios}" method="get"
          class="bg-white p-6 rounded-xl shadow-md mb-6 flex flex-col md:flex-row items-center gap-4">

        <div class="w-full md:w-1/2">
            <label class="font-semibold text-gray-700">Buscar por nombre:</label>
            <input type="text" name="nombre" th:value="${nombre}"
                   class="w-full px-4 py-2 border rounded-lg focus:ring focus:ring-indigo-200"
                   placeholder="Escribe un nombre...">
        </div>

        <div class="flex gap-3">
            <button type="submit"
                class="px-5 py-2 bg-[var(--secondary)] text-white rounded-lg hover:bg-teal-700 transition">
                Buscar
            </button>

            <button type="button" onclick="limpiarBusqueda()"
                class="px-5 py-2 bg-gray-300 text-gray-900 rounded-lg hover:bg-gray-400 transition">
                Limpiar
            </button>
        </div>
    </form>

    <!-- BOTÃ“N CREAR -->
    <div class="mb-6">
        <a th:href="@{/usuarios/nuevo}"
           class="px-6 py-3 bg-[var(--primary)] text-white rounded-lg shadow hover:bg-indigo-700 transition font-semibold">
            âž• Nuevo Usuario
        </a>
    </div>

    <!-- TABLA -->
    <div class="overflow-x-auto bg-white rounded-xl shadow-lg p-6">
        <table class="w-full border-collapse">
            <thead>
                <tr class="bg-indigo-100 text-indigo-800 font-semibold text-left">
                    <th class="p-3">ID</th>
                    <th class="p-3">Usuario</th>
                    <th class="p-3">Correo</th>
                    <th class="p-3">TelÃ©fono</th>

                    <!-- NUEVAS COLUMNAS -->
                    <th class="p-3">Tipo Doc</th>
                    <th class="p-3">Documento</th>

                    <th class="p-3">Rol</th>
                    <th class="p-3">Estado</th>
                    <th class="p-3">Fecha Registro</th>
                    <th class="p-3">Acciones</th>
                </tr>
            </thead>

            <tbody>
                <tr th:each="u : ${usuarios}" class="border-b hover:bg-gray-50">
                    <td class="p-3" th:text="${u.id}"></td>
                    <td class="p-3 font-medium" th:text="${u.userName}"></td>
                    <td class="p-3" th:text="${u.correoUsuario}"></td>
                    <td class="p-3" th:text="${u.telefonoUsuario}"></td>

                    <!-- DATOS NUEVOS -->
                    <td class="p-3" th:text="${u.tipoDocumento}"></td>
                    <td class="p-3" th:text="${u.numeroDocumento}"></td>

                    <td class="p-3" th:text="${u.rol}"></td>

                    <td class="p-3">
                        <span th:text="${u.estadoUsuario} ? 'Activo' : 'Inactivo'"
                              th:classappend="${u.estadoUsuario} ? 'text-green-600 font-semibold' : 'text-red-600 font-semibold'">
                        </span>
                    </td>

                    <td class="p-3" th:text="${u.createAt}"></td>

                    <td class="p-3 flex gap-2">
                        <a th:href="@{'/usuarios/editar/' + ${u.id}}"
                           class="px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition">
                            Editar
                        </a>

                        <a th:href="@{'/usuarios/eliminar/' + ${u.id}}"
                           onclick="return confirm('Â¿Eliminar usuario?')"
                           class="px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition">
                            Eliminar
                        </a>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- BOTÃ“N PDF -->
    <div class="text-right mt-6">
        <a th:href="@{/reporte-usuarios(nombre=${nombre})}"
           class="px-6 py-3 bg-yellow-500 text-white rounded-lg shadow hover:bg-yellow-600 transition">
            ðŸ“„ Descargar PDF
        </a>
    </div>

</section>

<script>
function limpiarBusqueda() {
    const input = document.querySelector("input[name='nombre']");
    const form = document.getElementById("form-busqueda");
    input.value = "";
    form.submit();
}
</script>

</body>
</html>
